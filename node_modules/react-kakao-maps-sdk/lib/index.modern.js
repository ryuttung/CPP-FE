import e,{useLayoutEffect as o,useEffect as t,useState as n,useRef as a,useImperativeHandle as r,useContext as i,useMemo as s}from"react";import l from"react-dom";const d="undefined"!=typeof window&&"undefined"!=typeof document?o:t,c=(e,o,t)=>{d(()=>{if(!e||!t)return;const n=(...o)=>void 0===o?t(e):t(e,...o);return kakao.maps.event.addListener(e,o,n),()=>{kakao.maps.event.removeListener(e,o,n)}},[e,o,t])};var p;!function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"}(p||(p={}));class k{constructor({appkey:e,id:o="__reactKakaoMapsSdkloaderId",libraries:t=[],nonce:n,retries:a=3,url:r="//dapi.kakao.com/v2/maps/sdk.js"}){if(this.id=void 0,this.appkey=void 0,this.url=void 0,this.libraries=void 0,this.nonce=void 0,this.retries=void 0,this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=void 0,this.id=o,this.appkey=e,this.libraries=t,this.nonce=n,this.retries=a,this.url=r,k.instance){if(!k.equalOptions(this.options,k.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(k.instance.options)}`);return k.instance}k.instance=this}get options(){return{appkey:this.appkey,id:this.id,libraries:this.libraries,nonce:this.nonce,retries:this.retries,url:this.url}}static isLoaded(){return new Promise(e=>window.kakao&&window.kakao.maps?e(!0):k.instance?k.instance.status===p.FAILURE||k.instance.status===p.INITIALIZED?e(!1):(k.instance.status===p.LOADING&&k.loadcheckcallbacks.push(o=>e(!o)),e(!0)):k.loadcheckcallbacks.push(o=>{e(!o)}))}load(){return new Promise((e,o)=>{this.loadCallback(t=>{t?o(t.error):e(window.kakao)})})}get status(){return this.onerrorEvent?p.FAILURE:this.done?p.SUCCESS:this.loading?p.LOADING:p.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}loadCallback(e){this.callbacks.push(e),this.execute()}resetIfRetryingFailed(){this.failed&&this.reset()}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=void 0}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.kakao&&window.kakao.maps)return console.warn("Kakao Maps이 이미 외부 요소에 의해 로딩되어 있습니다.설정한 옵션과 일치 하지 않을 수 있으며, 이에 따른 예상치 동작이 발생할 수 있습니다."),void this.callback();this.loading||(this.loading=!0,this.setScript())}}setScript(){document.getElementById(this.id)&&this.callback();const e=this.createUrl(),o=document.createElement("script");o.id=this.id,o.type="text/javascript",o.src=e,o.onerror=this.loadErrorCallback.bind(this),o.onload=this.callback.bind(this),o.defer=!0,o.async=!0,this.nonce&&(o.nonce=this.nonce),document.head.appendChild(o)}loadErrorCallback(e,o,t,n,a){if(this.errors.push({event:e,source:o,lineno:t,colno:n,error:a}),this.errors.length<=this.retries){const e=this.errors.length*2**this.errors.length;console.log(`Failed to load Kakao Maps script, retrying in ${e} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},e)}else this.onerrorEvent=this.errors[this.errors.length-1],this.callback()}createUrl(){let e=this.url;return e+=`?appkey=${this.appkey}`,this.libraries.length&&(e+=`&libraries=${this.libraries.join(",")}`),e+="&autoload=false",e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}callback(){kakao.maps.load(()=>{this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[],k.loadcheckcallbacks.forEach(e=>{e(this.onerrorEvent)}),k.loadcheckcallbacks=[]})}static equalOptions(e,o){if(e.appkey!==o.appkey)return!1;if(e.id!==o.id)return!1;if(e.libraries.length!==o.libraries.length)return!1;for(let t=0;t<e.libraries.length;++t)if(e.libraries[t]!==o.libraries[t])return!1;return e.nonce===o.nonce&&e.retries===o.retries&&e.url===o.url}}k.instance=void 0,k.loadcheckcallbacks=[];const u=e.createContext(void 0),m=e.forwardRef(({id:o="react-kakao-maps-sdk-map-container",style:t,children:i,center:s,isPanto:l=!1,padding:p=32,className:m,disableDoubleClick:g,disableDoubleClickZoom:h,draggable:w,zoomable:v,keyboardShortcuts:f,level:y,maxLevel:C,minLevel:b,mapTypeId:I,projectionId:O,scrollwheel:M,tileAnimation:L,onBoundsChanged:x,onCenterChanged:S,onClick:z,onDoubleClick:E,onDrag:P,onDragEnd:R,onDragStart:A,onIdle:D,onMaptypeidChanged:T,onMouseMove:W,onRightClick:Z,onTileLoaded:N,onZoomChanged:_,onZoomStart:j,onCreate:F},U)=>{const[G,V]=n(!1),[B,$]=n(),q=a(null);return d(()=>{k.isLoaded().then(V)},[]),d(()=>{if(!G)return;const e=q.current;if(!e)return;const o="lat"in s?new kakao.maps.LatLng(s.lat,s.lng):new kakao.maps.Coords(s.x,s.y),t=new kakao.maps.Map(e,{center:o,disableDoubleClick:g,disableDoubleClickZoom:h,draggable:w,keyboardShortcuts:f,level:y,mapTypeId:I,projectionId:O,scrollwheel:M,tileAnimation:L});$(t)},[G,g,h,I,L]),r(U,()=>B,[B]),d(()=>{B&&F&&F(B)},[B,F]),d(()=>{if(!B)return;let e=B.getCenter();e instanceof kakao.maps.Coords&&(e=e.toLatLng());const o="lat"in s?new kakao.maps.LatLng(s.lat,s.lng):new kakao.maps.Coords(s.x,s.y);o instanceof kakao.maps.LatLng&&o.equals(e)||o instanceof kakao.maps.Coords&&o.toLatLng().equals(e)||(l?B.panTo(o,p):B.setCenter(o))},[B,s.lat,s.lng,s.x,s.y]),d(()=>{B&&void 0!==w&&B.setDraggable(w)},[B,w]),d(()=>{B&&void 0!==v&&B.setZoomable(v)},[B,v]),d(()=>{B&&f&&"boolean"==typeof f&&B.setKeyboardShortcuts(f)},[B,f]),d(()=>{B&&y&&B.setLevel(y)},[B,y]),d(()=>{B&&I&&B.setMapTypeId(I)},[B,I]),d(()=>{B&&O&&B.setProjectionId(O)},[B,O]),d(()=>{B&&C&&B.setMaxLevel(C)},[B,C]),d(()=>{B&&b&&B.setMinLevel(b)},[B,b]),c(B,"bounds_changed",x),c(B,"center_changed",S),c(B,"click",z),c(B,"dblclick",E),c(B,"drag",P),c(B,"dragstart",A),c(B,"dragend",R),c(B,"idle",D),c(B,"maptypeid_changed",T),c(B,"mousemove",W),c(B,"rightclick",Z),c(B,"tilesloaded",N),c(B,"zoom_changed",_),c(B,"zoom_start",j),e.createElement(e.Fragment,null,e.createElement("div",{id:o,style:t,className:m,ref:q}),B&&e.createElement(u.Provider,{value:B},i))}),g=e=>{const o=i(u);if(!o)throw new Error((e?e+" Component":"useMap")+" must exist inside Map Component!");return o},h=e.forwardRef(({map:e,position:t,marker:n,children:i,altitude:d,disableAutoPan:c,range:p,removable:k,zIndex:u,onCreate:m},g)=>{const h=a(document.createElement("div")),w=s(()=>{const e=new kakao.maps.InfoWindow({altitude:d,disableAutoPan:c,range:p,removable:k,zIndex:u,content:h.current,position:t});return h.current.style.display="none",e},[c,k]);return r(g,()=>w,[w]),o(()=>(w.open(e,n),()=>{w.close()}),[e,n]),o(()=>{m&&m(w)},[w,m]),o(()=>{w&&w.setPosition(t)},[w,t]),o(()=>{w&&d&&w.setAltitude(d)},[w,d]),o(()=>{w&&p&&w.setRange(p)},[w,p]),o(()=>{w&&u&&w.setZIndex(u)},[w,u]),h.current.parentElement&&l.createPortal(i,h.current.parentElement)}),w=e.createContext(void 0),v=e.forwardRef(({children:t,averageCenter:n,calculator:a,clickable:i,disableClickZoom:l,gridSize:d,hoverable:p,minClusterSize:k,minLevel:u,styles:m,texts:h,onClusterclick:v,onClusterdblclick:f,onClustered:y,onClusterout:C,onClusterover:b,onClusterrightclick:I,onCreate:O},M)=>{const L=g("MarkerClusterer"),x=s(()=>{if(window.kakao.maps.MarkerClusterer)return new kakao.maps.MarkerClusterer({averageCenter:n,calculator:a,clickable:i,disableClickZoom:l,gridSize:d,hoverable:p,minClusterSize:k,minLevel:u,styles:m,texts:h});console.warn("clusterer 라이브러리를 별도 로드 해야 사용 가능합니다. `https://apis.map.kakao.com/web/guide/#loadlibrary`")},[]);return r(M,()=>x,[x]),o(()=>{null==x||x.setMap(L)},[L,x]),o(()=>{x&&O&&O(x)},[x,O]),o(()=>{x&&d&&(x.setGridSize(d),x.redraw())},[x,d]),o(()=>{x&&k&&(x.setMinClusterSize(k),x.redraw())},[x,k]),o(()=>{x&&void 0!==n&&(x.setAverageCenter(n),x.redraw())},[x,n]),o(()=>{x&&u&&(x.setMinLevel(u),x.redraw())},[x,u]),o(()=>{x&&h&&(x.setTexts(h),x.redraw())},[x,h]),o(()=>{x&&a&&(x.setCalculator(a),x.redraw())},[x,a]),o(()=>{x&&m&&(x.setStyles(m),x.redraw())},[x,m]),c(x,"clusterclick",v),c(x,"clusterover",b),c(x,"clusterout",C),c(x,"clusterdblclick",f),c(x,"clusterrightclick",I),c(x,"clustered",y),x?e.createElement(w.Provider,{value:x},t):null}),f=e.forwardRef(({map:t,position:n,children:a,altitude:l,clickable:d,draggable:p,image:k,infoWindowOptions:u,onCreate:m,onClick:g,onDragEnd:v,onDragStart:f,onMouseOut:y,onMouseOver:C,opacity:b,range:I,title:O,zIndex:M},L)=>{const x=i(w),S=s(()=>new kakao.maps.Marker({altitude:l,clickable:d,draggable:p,image:k,opacity:b,range:I,title:O,zIndex:M,position:n}),[]);return r(L,()=>S,[S]),o(()=>(x?x.addMarker(S):S.setMap(t),()=>{x?x.removeMarker(S):S.setMap(null)}),[t,x,S]),o(()=>{m&&m(S)},[S,m]),c(S,"click",g),c(S,"dragstart",f),c(S,"dragend",v),c(S,"mouseout",y),c(S,"mouseover",C),o(()=>{t&&S&&n&&S.setPosition(n)},[t,S,n]),o(()=>{t&&S&&k&&S.setImage(k)},[t,S,k]),o(()=>{t&&S&&l&&S.setAltitude(l)},[t,S,l]),o(()=>{t&&S&&void 0!==d&&S.setClickable(d)},[t,S,d]),o(()=>{t&&S&&void 0!==p&&S.setDraggable(p)},[t,S,p]),o(()=>{t&&S&&b&&S.setOpacity(b)},[t,S,b]),o(()=>{t&&S&&I&&S.setRange(I)},[t,S,I]),o(()=>{t&&S&&O&&S.setTitle(O)},[t,S,O]),o(()=>{t&&S&&M&&S.setZIndex(M)},[t,S,M]),a?e.createElement(h,{position:n,map:t,marker:S,altitude:null==u?void 0:u.altitude,disableAutoPan:null==u?void 0:u.disableAutoPan,range:null==u?void 0:u.range,removable:null==u?void 0:u.removable,zIndex:null==u?void 0:u.zIndex},a):null}),y=e.forwardRef(({image:o,position:t,children:n,clickable:a,draggable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:k,onCreate:u,opacity:m,title:h,zIndex:w},v)=>{const y=g("MapMarker"),C=s(()=>{var e,t,n,a,r,i,s,l,d,c,p,k;return o&&new kakao.maps.MarkerImage(o.src,new kakao.maps.Size(o.size.width,o.size.height),{alt:null==(e=o.options)?void 0:e.alt,coords:null==(t=o.options)?void 0:t.coords,offset:(null==(n=o.options)?void 0:n.offset)&&new kakao.maps.Point(null==(a=o.options)?void 0:a.offset.x,null==(r=o.options)?void 0:r.offset.y),shape:null==(i=o.options)?void 0:i.shape,spriteOrigin:(null==(s=o.options)?void 0:s.spriteOrigin)&&new kakao.maps.Point(null==(l=o.options)?void 0:l.spriteOrigin.x,null==(d=o.options)?void 0:d.spriteOrigin.y),spriteSize:(null==(c=o.options)?void 0:c.spriteSize)&&new kakao.maps.Size(null==(p=o.options)?void 0:p.spriteSize.width,null==(k=o.options)?void 0:k.spriteSize.height)})},[o]),b=s(()=>"lat"in t?new kakao.maps.LatLng(t.lat,t.lng):new kakao.maps.Coords(t.x,t.y).toLatLng(),[t.lat,t.lng,t.x,t.y]);return e.createElement(f,{map:y,position:b,image:C,clickable:a,draggable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:k,onCreate:u,opacity:m,title:h,zIndex:w,ref:v},n)}),C=e.forwardRef(({position:o,children:t,disableAutoPan:n,removable:a,zIndex:r,onCreate:i},l)=>{const d=g("MapInfoWindow"),c=s(()=>new kakao.maps.LatLng(o.lat,o.lng),[o.lat,o.lng]);return e.createElement(h,{disableAutoPan:n,removable:a,zIndex:r,map:d,position:c,onCreate:i,ref:l},t)}),b=e.forwardRef(({position:e,children:t,clickable:n,xAnchor:d,yAnchor:c,zIndex:p,onCreate:k},u)=>{const m=i(w),h=g("CustomOverlayMap"),v=a(document.createElement("div")),f=s(()=>new kakao.maps.LatLng(e.lat,e.lng),[e.lat,e.lng]),y=s(()=>{const e=new kakao.maps.CustomOverlay({clickable:n,xAnchor:d,yAnchor:c,zIndex:p,position:f,content:v.current});return v.current.style.display="none",e},[n,d,c]);return r(u,()=>y,[y]),o(()=>{if(h)return m?m.addMarker(y):y.setMap(h),()=>{m?m.removeMarker(y):y.setMap(null)}},[h,m,y]),o(()=>{k&&k(y)},[y,k]),o(()=>{y.setPosition(f)},[y,f]),o(()=>{p&&y.setZIndex(p)},[y,p]),v.current.parentElement&&l.createPortal(t,v.current.parentElement)}),I=e.forwardRef(({position:e=kakao.maps.ControlPosition.TOPRIGHT},t)=>{const n=g("MapTypeControl"),a=s(()=>new kakao.maps.MapTypeControl,[]);return r(t,()=>a,[a]),o(()=>(n.addControl(a,e),()=>{n.removeControl(a)}),[n,a,e]),null}),O=e.forwardRef(({position:e=kakao.maps.ControlPosition.RIGHT},o)=>{const n=g("ZoomControl"),a=s(()=>new kakao.maps.ZoomControl,[]);return r(o,()=>a,[a]),t(()=>(n.addControl(a,e),()=>{n.removeControl(a)}),[n,e]),null}),M=({type:e})=>{const o=g("MapTypeId");return t(()=>(o.addOverlayMapTypeId(e),()=>{o.removeOverlayMapTypeId(e)}),[o,e]),null},L=e.forwardRef(({center:e,radius:t,fillColor:n,fillOpacity:a,strokeColor:i,strokeOpacity:l,strokeStyle:d,strokeWeight:p,zIndex:k,onMouseover:u,onMouseout:m,onMousemove:h,onMousedown:w,onClick:v,onCreate:f},y)=>{const C=g("Circle"),b=s(()=>new kakao.maps.LatLng(e.lat,e.lng),[e.lat,e.lng]),I=s(()=>new kakao.maps.Circle({center:b,radius:t,fillColor:n,fillOpacity:a,strokeColor:i,strokeOpacity:l,strokeStyle:d,strokeWeight:p,zIndex:k}),[]);return r(y,()=>I,[I]),o(()=>(I.setMap(C),()=>{I.setMap(null)}),[C,I]),o(()=>{f&&f(I)},[I,f]),o(()=>{I&&I.setPosition(b)},[I,b]),o(()=>{I.setRadius(t)},[I,t]),o(()=>{k&&I.setZIndex(k)},[I,k]),o(()=>{I.setOptions({fillColor:n,fillOpacity:a,strokeColor:i,strokeOpacity:l,strokeStyle:d,strokeWeight:p})},[I,n,a,i,l,d,p]),c(I,"mouseover",u),c(I,"mouseout",m),c(I,"mousemove",h),c(I,"mousedown",w),c(I,"click",v),null}),x=e.forwardRef(({path:e,endArrow:t,onClick:n,onMousedown:a,onMousemove:i,onMouseout:l,onMouseover:d,onCreate:p,strokeColor:k,strokeOpacity:u,strokeStyle:m,strokeWeight:h,zIndex:w},v)=>{const f=g("Polyline"),y=s(()=>e.every(e=>e instanceof Array)?e.map(e=>e.map(e=>new kakao.maps.LatLng(e.lat,e.lng))):e.map(e=>new kakao.maps.LatLng(e.lat,e.lng)),[e]),C=s(()=>new kakao.maps.Polyline({path:y,endArrow:t,strokeColor:k,strokeOpacity:u,strokeStyle:m,strokeWeight:h,zIndex:w}),[]);return r(v,()=>C,[C]),o(()=>(C.setMap(f),()=>C.setMap(null)),[f,C]),o(()=>{p&&p(C)},[C,p]),o(()=>{C.setOptions({endArrow:t,strokeColor:k,strokeOpacity:u,strokeStyle:m,strokeWeight:h})},[C,t,k,u,m,h]),o(()=>{C.setPath(y)},[C,y]),o(()=>{w&&C.setZIndex(w)},[C,w]),c(C,"mouseover",d),c(C,"mouseout",l),c(C,"mousemove",i),c(C,"mousedown",a),c(C,"click",n),null}),S=e.forwardRef(({path:e,onClick:t,onMousedown:n,onMousemove:a,onMouseout:i,onMouseover:l,onCreate:d,strokeColor:p,strokeOpacity:k,strokeStyle:u,strokeWeight:m,fillColor:h,fillOpacity:w,zIndex:v},f)=>{const y=g("Polygon"),C=s(()=>e.every(e=>e instanceof Array)?e.map(e=>e.map(e=>new kakao.maps.LatLng(e.lat,e.lng))):e.map(e=>new kakao.maps.LatLng(e.lat,e.lng)),[e]),b=s(()=>new kakao.maps.Polygon({path:C,fillColor:h,fillOpacity:w,strokeColor:p,strokeOpacity:k,strokeStyle:u,strokeWeight:m,zIndex:v}),[]);return r(f,()=>b,[b]),o(()=>(b.setMap(y),()=>b.setMap(null)),[y,b]),o(()=>{d&&d(b)},[b,d]),o(()=>{b.setOptions({fillColor:h,fillOpacity:w,strokeColor:p,strokeOpacity:k,strokeStyle:u,strokeWeight:m})},[b,h,w,p,k,u,m]),o(()=>{b.setPath(C)},[b,C]),o(()=>{v&&b.setZIndex(v)},[b,v]),c(b,"mouseover",l),c(b,"mouseout",i),c(b,"mousemove",a),c(b,"mousedown",n),c(b,"click",t),null}),z=e.forwardRef(({bounds:e,onClick:t,onMousedown:n,onMousemove:a,onMouseout:i,onMouseover:l,onCreate:d,strokeColor:p,strokeOpacity:k,strokeStyle:u,strokeWeight:m,fillColor:h,fillOpacity:w,zIndex:v},f)=>{const y=g("Rectangle"),C=s(()=>new kakao.maps.LatLngBounds(new kakao.maps.LatLng(e.sw.lat,e.sw.lng),new kakao.maps.LatLng(e.ne.lat,e.ne.lng)),[e]),b=s(()=>new kakao.maps.Rectangle({bounds:C,fillColor:h,fillOpacity:w,strokeColor:p,strokeOpacity:k,strokeStyle:u,strokeWeight:m,zIndex:v}),[]);return r(f,()=>b,[b]),o(()=>(b.setMap(y),()=>b.setMap(null)),[y,b]),o(()=>{d&&d(b)},[b,d]),o(()=>{b.setOptions({fillColor:h,fillOpacity:w,strokeColor:p,strokeOpacity:k,strokeStyle:u,strokeWeight:m})},[b,h,w,p,k,u,m]),o(()=>{b.setBounds(C)},[b,C]),o(()=>{v&&b.setZIndex(v)},[b,v]),c(b,"mouseover",l),c(b,"mouseout",i),c(b,"mousemove",a),c(b,"mousedown",n),c(b,"click",t),null}),E=e.forwardRef(({center:e,rx:t,ry:n,fillColor:a,fillOpacity:i,strokeColor:l,strokeOpacity:d,strokeStyle:p,strokeWeight:k,zIndex:u,onMouseover:m,onMouseout:h,onMousemove:w,onMousedown:v,onClick:f,onCreate:y},C)=>{const b=g("Ellipse"),I=s(()=>new kakao.maps.LatLng(e.lat,e.lng),[e.lat,e.lng]),O=s(()=>new kakao.maps.Ellipse({center:I,rx:t,ry:n,fillColor:a,fillOpacity:i,strokeColor:l,strokeOpacity:d,strokeStyle:p,strokeWeight:k,zIndex:u}),[]);return r(C,()=>O,[O]),o(()=>(O.setMap(b),()=>{O.setMap(null)}),[b,O]),o(()=>{y&&y(O)},[O,y]),o(()=>{O&&O.setPosition(I)},[O,I]),o(()=>{O.setRadius(t,n)},[O,t,n]),o(()=>{u&&O.setZIndex(u)},[O,u]),o(()=>{O.setOptions({fillColor:a,fillOpacity:i,strokeColor:l,strokeOpacity:d,strokeStyle:p,strokeWeight:k})},[O,a,i,l,d,p,k]),c(O,"mouseover",m),c(O,"mouseout",h),c(O,"mousemove",w),c(O,"mousedown",v),c(O,"click",f),null}),P=e.forwardRef(({draw:e,onAdd:t,onRemove:n,onCreate:a},i)=>{const l=g(),d=s(()=>{class o extends kakao.maps.AbstractOverlay{constructor(e,o,t){super(),this.draw=e,this.onAdd=o,this.onRemove=t}}return new o(e,t,n)},[e,t,n]);return r(i,()=>d,[d]),o(()=>(d.setMap(l),()=>{d.setMap(null)}),[l,d]),o(()=>{a&&a(d)},[d,a]),null}),R=e.createContext(void 0),A=e.forwardRef(({id:o="react-kakao-maps-sdk-roadview-container",style:t,children:i,position:s,className:l,pan:p,panoId:u,panoX:m,panoY:g,tilt:h,zoom:w,onCreate:v,onInit:f,onPanoidChange:y,onPositionChanged:C,onViewpointChange:b,onErrorGetNearestPanoId:I},O)=>{const[M,L]=n(!1),[x,S]=n(!0),[z,E]=n(),P=a(null);return d(()=>{k.isLoaded().then(L)},[]),d(()=>{if(!M)return;if(!P.current)return;const e=new kakao.maps.Roadview(P.current,{pan:p,panoId:u,panoX:m,panoY:g,tilt:h,zoom:w});E(e)},[M,m,g,w]),r(O,()=>z,[z]),d(()=>{z&&v&&v(z)},[z,v]),d(()=>{if(!z||u||z.getPosition().getLat()===s.lat&&z.getPosition().getLng()===s.lng)return;const e=new kakao.maps.LatLng(s.lat,s.lng);(new kakao.maps.RoadviewClient).getNearestPanoId(e,s.radius,o=>{null===o&&I?I(z):z.setPanoId(o,e)})},[z,u,s.lat,s.lng,s.radius,I]),d(()=>{if(!z||!u||u===z.getPanoId()||z.getPosition().getLat()===s.lat&&z.getPosition().getLng()===s.lng)return;const e=new kakao.maps.LatLng(s.lat,s.lng);z.setPanoId(u,e)},[z,u,s.lat,s.lng]),d(()=>{if(!z)return;const e=z.getViewpoint();e.pan===p&&e.tilt===h||(p&&(e.pan=p),h&&(e.tilt=h),z.setViewpoint(e))},[z,p,h]),c(z,"init",e=>{S(!1),f&&f(e)}),c(z,"panoid_changed",y),c(z,"viewpoint_changed",b),c(z,"position_changed",C),e.createElement(e.Fragment,null,e.createElement("div",{id:o,className:l,style:t,ref:P}),z&&!x&&e.createElement(R.Provider,{value:z},i))}),D=e=>{const o=i(R);if(!o)throw new Error((e?e+" Component":"useRoadview")+" must exist inside Roadview Component!");return o},T=e.forwardRef(({position:e,children:t,clickable:n,xAnchor:i,yAnchor:d,zIndex:c,altitude:p,range:k,onCreate:u},m)=>{const g=D("CustomOverlayRoadview"),h=a(document.createElement("div")),w=s(()=>"lat"in e?new kakao.maps.LatLng(e.lat,e.lng):new kakao.maps.Viewpoint(e.pan,e.tilt,e.zoom,e.panoId),[e.lat,e.lng,e.pan,e.tilt,e.zoom,e.panoId]),v=s(()=>{const e=new kakao.maps.CustomOverlay({clickable:n,xAnchor:i,yAnchor:d,zIndex:c,position:w,content:h.current});return h.current.style.display="none",e},[n,i,d]);return r(m,()=>v,[v]),o(()=>{if(g)return v.setMap(g),()=>{v.setMap(null)}},[v,g]),o(()=>{u&&u(v)},[v,u]),o(()=>{v.setPosition(w)},[v,w]),o(()=>{c&&v.setZIndex(c)},[v,c]),o(()=>{p&&v.setAltitude(p)},[v,p]),o(()=>{k&&v.setRange(k)},[v,k]),h.current.parentElement&&l.createPortal(t,h.current.parentElement)}),W=e.forwardRef(({image:o,position:t,children:n,altitude:a,clickable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:k,onCreate:u,opacity:m,range:g,title:h,zIndex:w},v)=>{const y=D("RoadviewMarker"),C=s(()=>{var e,t,n,a,r,i,s,l,d,c,p,k;return o&&new kakao.maps.MarkerImage(o.src,new kakao.maps.Size(o.size.width,o.size.height),{alt:null==(e=o.options)?void 0:e.alt,coords:null==(t=o.options)?void 0:t.coords,offset:(null==(n=o.options)?void 0:n.offset)&&new kakao.maps.Point(null==(a=o.options)?void 0:a.offset.x,null==(r=o.options)?void 0:r.offset.y),shape:null==(i=o.options)?void 0:i.shape,spriteOrigin:(null==(s=o.options)?void 0:s.spriteOrigin)&&new kakao.maps.Point(null==(l=o.options)?void 0:l.spriteOrigin.x,null==(d=o.options)?void 0:d.spriteOrigin.y),spriteSize:(null==(c=o.options)?void 0:c.spriteSize)&&new kakao.maps.Size(null==(p=o.options)?void 0:p.spriteSize.width,null==(k=o.options)?void 0:k.spriteSize.height)})},[o]),b=s(()=>"lat"in t?new kakao.maps.LatLng(t.lat,t.lng):"x"in t?new kakao.maps.Coords(t.x,t.y).toLatLng():new kakao.maps.Viewpoint(t.pan,t.tilt,t.zoom,t.panoId),[t.lat,t.lng,t.x,t.y,t.pan,t.tilt,t.zoom,null==t?void 0:t.panoId]);return e.createElement(f,{map:y,position:b,image:C,altitude:a,clickable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:k,onCreate:u,opacity:m,range:g,title:h,zIndex:w,ref:v},n)}),Z=e.forwardRef(({position:o,children:t,altitude:n,disableAutoPan:a,range:r,removable:i,zIndex:l,onCreate:d},c)=>{const p=D("RoadviewInfoWindow"),k=s(()=>"lat"in o?new kakao.maps.LatLng(o.lat,o.lng):new kakao.maps.Viewpoint(o.pan,o.tilt,o.zoom,o.panoId),[o.lat,o.lng,o.pan,o.tilt,o.zoom,o.panoId]);return e.createElement(h,{altitude:n,disableAutoPan:a,range:r,removable:i,zIndex:l,map:p,position:k,onCreate:d,ref:c},t)}),N=e.createContext(void 0);function _(e,t,n){o(()=>{e&&n&&e.addListener(t,(...o)=>void 0===o?n(e):n(e,...o))},[n,e,t])}const j=e.forwardRef(function({arrowOptions:t,circleOptions:n,ellipseOptions:a,markerOptions:i,polygonOptions:l,polylineOptions:d,rectangleOptions:c,drawingMode:p,guideTooltip:k,onSelect:u,onDrawstart:m,onDraw:h,onDrawend:w,onDrawnext:v,onCancle:f,onRemove:y,onStateChanged:C,onCreate:b,children:I},O){const M=g("Toolbox"),L=s(()=>{if(window.kakao.maps.drawing)return new kakao.maps.drawing.DrawingManager({map:M,drawingMode:p,guideTooltip:k,arrowOptions:t,circleOptions:n,ellipseOptions:a,markerOptions:i,polygonOptions:l,polylineOptions:d,rectangleOptions:c});console.warn("drawing 라이브러리를 별도 로드 해야 사용 가능합니다. `https://apis.map.kakao.com/web/guide/#loadlibrary`")},[]);return r(O,()=>L,[L]),o(()=>{L&&b&&b(L)},[L,b]),_(L,"select",u),_(L,"drawstart",m),_(L,"draw",h),_(L,"drawend",w),_(L,"drawnext",v),_(L,"cancel",f),_(L,"remove",y),_(L,"state_changed",C),L?e.createElement(N.Provider,{value:L},I):null}),F=e.forwardRef(function({position:e},t){e=e||kakao.maps.ControlPosition.TOP;const n=g("Toolbox"),a=i(N);if(!a)throw new Error("Toolbox must exist inside DrawingManager Component!`");const l=s(()=>new kakao.maps.drawing.Toolbox({drawingManager:a}),[a]);return r(t,()=>l,[l]),o(()=>{const o=l.getElement();return n.addControl(o,e),()=>{n.removeControl(o)}},[n,l,e]),null});function U(){return(U=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}const G=e.forwardRef(({id:o="react-kakao-maps-sdk-staticmap-container",style:t,className:i,center:s,marker:l,level:c,mapTypeId:p,onCreate:k},u)=>{const[m,g]=n(),h=a(null);return d(()=>{if(!window.kakao)return void console.warn("kakao map javascript api를 먼저 불러와야 합니다. `https://apis.map.kakao.com/web/guide`");const e=h.current;e&&kakao.maps.load(()=>{const o=Array.isArray(l)?l.map(e=>U({},e,{position:new kakao.maps.LatLng(e.position.lat,e.position.lng)})):"object"==typeof l&&l.position?U({},l,{position:new kakao.maps.LatLng(l.position.lat,l.position.lng)}):l,t=new kakao.maps.StaticMap(e,{center:new kakao.maps.LatLng(s.lat,s.lng),level:c,mapTypeId:p,marker:o});g(t)})},[JSON.stringify(l)]),r(u,()=>m,[m]),d(()=>{m&&m.setCenter(new kakao.maps.LatLng(s.lat,s.lng))},[m,s.lat,s.lng]),d(()=>{m&&c&&m.setLevel(c)},[m,c]),d(()=>{m&&p&&m.setMapTypeId(p)},[m,p]),d(()=>{m&&k&&k(m)},[m,k]),e.createElement("div",{id:o,style:t,className:i,ref:h})}),V=e=>{const[o,a]=n({loading:!0,error:void 0}),r=s(()=>new k(e),[JSON.stringify(e)]);return t(()=>{r.load().then(()=>a({loading:!1,error:void 0})).catch(e=>a({loading:!1,error:e}))},[r]),o};export{P as AbstractOverlay,L as Circle,b as CustomOverlayMap,T as CustomOverlayRoadview,j as DrawingManager,E as Ellipse,k as Loader,m as Map,C as MapInfoWindow,y as MapMarker,I as MapTypeControl,M as MapTypeId,v as MarkerClusterer,S as Polygon,x as Polyline,z as Rectangle,A as Roadview,Z as RoadviewInfoWindow,W as RoadviewMarker,G as StaticMap,F as Toolbox,O as ZoomControl,V as useInjectKakaoMapApi,g as useMap,D as useRoadview};
//# sourceMappingURL=index.modern.js.map
